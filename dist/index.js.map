{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["const node = str => new DOMParser().parseFromString(str, 'text/html').body.firstChild;\n\nfunction EventEmitter() {\n\tconst topic = {};\n\n\treturn {\n\t\ton(name, listener) {\n\t\t\tif (!topic[name]) {\n\t\t\t\ttopic[name] = { queue: [] };\n\t\t\t}\n\t\t\ttopic[name].queue.push(listener) - 1;\n\t\t},\n\t\temit(name, data) {\n\t\t\tif (!topic[name] || topic[name].queue.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttopic[name].queue.forEach(callback => callback(data));\n\t\t},\n\t};\n}\n\nconst getCssBlock = (selector, property, values) => {\n\tconst block = (value) => `.${selector} { ${property}: ${ value }; }`;\n\tif (typeof values === 'object') {\n\t\treturn Object.keys(values).map(key => {\n\t\t\tif (key === '&') {\n\t\t\t\treturn block(values[key]);\n\t\t\t} else {\n\t\t\t\treturn `@media screen and (${key}) { ${block(values[key])} }`;\n\t\t\t}\n\t\t}).join('');\n\t}\n\treturn block(values);\n};\n\nexport default function debugGrid({\n\tcolumns = 12,\n\tmaxWidth = null,\n\tmarginsWidth = null,\n\tgutterWidth = '16px',\n\tcolumnWidth = '1fr',\n\tverticalRhythm = '20px',\n\tkeyCode = 71, // Lowercase \"g\"\n} = {}) {\n\tconst { emit, on } = new EventEmitter();\n\n\tconst grid = 'g' + Math.random().toString(36).substr(2, 9);\n\tconst gridInner = 'i' + Math.random().toString(36).substr(2, 9);\n\n\tlet css = `\n\t\t.${grid} {\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\tbottom: 0;\n\t\t\tz-index: 10000;\n\t\t\tmargin: 0;\n\t\t\tpadding: 0;\n\t\t\tpointer-events: none;\n\t\t}\n\n\t\t.${gridInner} {\n\t\t\tdisplay: grid;\n\t\t\theight: 100%;\n\t\t\tbackground-color: rgba(14, 109, 14, 0.1);\n\t\t\tmargin-left: auto;\n\t\t\tmargin-right: auto;\n\t\t\tbox-sizing: content-box;\n\t\t\tgrid-template-columns: repeat(${columns}, ${columnWidth});\n\t\t\tcolumn-gap: ${gutterWidth};\n\t\t}\n\n\t\t.${gridInner}::before {\n\t\t\tcontent: \"\";\n\t\t\tposition: absolute;\n\t\t\tleft: calc(50% - 1px);\n\t\t\twidth: 1px;\n\t\t\theight: 100%;\n\t\t\tbackground: #bbb;\n\t\t\topacity: 0.6;\n\t\t}\n\n\t\t.${gridInner}::after {\n\t\t\tcontent: \"\";\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\tbottom: 0;\n\t\t\topacity: 0.4;\n\t\t\tbackground-image: linear-gradient(to bottom, cyan 0, transparent 1px);\n\t\t\tbackground-repeat: repeat-y;\n\t\t\tbackground-size: 100% ${verticalRhythm};\n\t\t}\n\n\t\t.${gridInner} > div {\n\t\t\tmargin-top: 0;\n\t\t\tbackground-color: rgba(255, 192, 203, 0.2);\n\t\t}\n\t`;\n\n\tcss += Object.entries(arguments[0]).map(([key, value]) => {\n\t\tconst cases = {\n\t\t\tmarginsWidth() {\n\t\t\t\treturn [\n\t\t\t\t\tgetCssBlock(gridInner, 'padding-left', value),\n\t\t\t\t\tgetCssBlock(gridInner, 'padding-right', value),\n\t\t\t\t].join('');\n\t\t\t},\n\t\t\tmaxWidth() {\n\t\t\t\treturn getCssBlock(gridInner, 'max-width', value);\n\t\t\t},\n\t\t\tgutterWidth() {\n\t\t\t\treturn getCssBlock(gridInner, 'column-gap', value);\n\t\t\t},\n\t\t\tdefault() {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t};\n\t\treturn (cases[key] || cases['default'])();\n\t}).join('');\n\n\tconst styleTag = document.createElement('style');\n\tstyleTag.id = 'debug-grid-overlay';\n\tstyleTag.innerHTML = css.replace(/\\n/g, '').replace(/\\s\\s+/g, ' ');\n\n\tconst overlay = node(`\n\t\t<div class=\"${grid} debug-grid-overlay\">\n\t\t\t<div class=\"${gridInner}\">\n\t\t\t\t${Array.from({length: columns}, () => `<div></div>`).join('')}\n\t\t\t</div>\n\t\t</div>\n\t`);\n\n\tfunction toggle() {\n\t\tif (document.body.contains(overlay)) {\n\t\t\tdocument.head.removeChild(styleTag);\n\t\t\tdocument.body.removeChild(overlay);\n\t\t\temit('toggled', false);\n\t\t} else {\n\t\t\tdocument.head.insertAdjacentElement('beforeend', styleTag);\n\t\t\tdocument.body.append(overlay);\n\t\t\temit('toggled', true);\n\t\t}\n\t}\n\n\twindow.addEventListener('keydown', e => {\n\t\tif (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA') return;\n\t\tif (event.keyCode === keyCode) {\n\t\t\ttoggle();\n\t\t}\n\t});\n\n\treturn { toggle, on };\n}\n"],"names":["EventEmitter","topic","on","name","listener","queue","push","emit","data","length","forEach","callback","const","getCssBlock","selector","property","values","block","value","Object","keys","map","key","join","ref","grid","Math","random","toString","substr","gridInner","css","columns","columnWidth","gutterWidth","verticalRhythm","entries","arguments","cases","marginsWidth","maxWidth","default","styleTag","document","createElement","id","innerHTML","replace","str","overlay","Array","from","DOMParser","parseFromString","body","firstChild","toggle","contains","head","removeChild","insertAdjacentElement","append","window","addEventListener","e","activeElement","tagName","event","keyCode"],"mappings":"AAEA,SAASA,QACFC,EAAQ,SAEP,CACNC,YAAGC,EAAMC,GACHH,EAAME,KACVF,EAAME,GAAQ,CAAEE,MAAO,KAExBJ,EAAME,GAAME,MAAMC,KAAKF,IAExBG,cAAKJ,EAAMK,GACLP,EAAME,IAAsC,IAA7BF,EAAME,GAAME,MAAMI,QAGtCR,EAAME,GAAME,MAAMK,iBAAQC,UAAYA,EAASH,OAKlDI,IAAMC,WAAeC,EAAUC,EAAUC,OAClCC,WAASC,aAAcJ,QAAcC,OAAcG,eACnC,iBAAXF,EACHG,OAAOC,KAAKJ,GAAQK,aAAIC,SAClB,MAARA,EACIL,EAAMD,EAAOM,0BAESA,SAAUL,EAAMD,EAAOM,WAEnDC,KAAK,IAEFN,EAAMD,mBAGC,SAAmBQ,kBAQ9B,mCAPO,uCAGI,2CACA,6CACG,uCACP,UAEW,IAAIxB,kBAEnByB,EAAO,IAAMC,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,GAClDC,EAAY,IAAMJ,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,GAEzDE,EAAO,UACPN,6MAYAK,8NAO8BE,OAAYC,2BAC9BC,sBAGZJ,kMAUAA,oSAUsBK,sBAGtBL,iGAMJC,GAAOZ,OAAOiB,QAAQC,UAAU,IAAIhB,aAAKG,cAClCc,EAAQ,CACbC,8BACQ,CACN1B,EAAYiB,EAAW,eAAgBZ,GACvCL,EAAYiB,EAAW,gBAAiBZ,IACvCK,KAAK,KAERiB,2BACQ3B,EAAYiB,EAAW,YAAaZ,IAE5CgB,8BACQrB,EAAYiB,EAAW,aAAcZ,IAE7CuB,yBACQ,YAGDH,SAAcA,EAAK,aACzBf,KAAK,QAEFmB,EAAWC,SAASC,cAAc,SACxCF,EAASG,GAAK,qBACdH,EAASI,UAAYf,EAAIgB,QAAQ,MAAO,IAAIA,QAAQ,SAAU,SA7HlDC,EA+HNC,GA/HMD,uBAgIGvB,8CACCK,iBACXoB,MAAMC,KAAK,CAAC1C,OAAQuB,oBAAiB,gBAAcT,KAAK,sCAlI1C,IAAI6B,WAAYC,gBAAgBL,EAAK,aAAaM,KAAKC,qBAuIjEC,IACJb,SAASW,KAAKG,SAASR,IAC1BN,SAASe,KAAKC,YAAYjB,GAC1BC,SAASW,KAAKK,YAAYV,GAC1B1C,EAAK,WAAW,KAEhBoC,SAASe,KAAKE,sBAAsB,YAAalB,GACjDC,SAASW,KAAKO,OAAOZ,GACrB1C,EAAK,WAAW,WAIlBuD,OAAOC,iBAAiB,mBAAWC,GACK,UAAnCrB,SAASsB,cAAcC,SAA0D,aAAnCvB,SAASsB,cAAcC,SACrEC,MAAMC,UAAYA,GACrBZ,MAIK,QAAEA,KAAQtD"}